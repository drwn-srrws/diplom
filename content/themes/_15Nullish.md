---
MainTheme: "Оператор об’єднання з null '??'"

PageThemes:
  [
    { name: "Порівняння з ||", url: "porivnyannya-z" },
    { name: "Пріоритет", url: "prioritet" },
    { name: "Підсумки", url: "pidsumki" },
  ]
---

<Column>
# Оператор об’єднання з null '??'

<Extra>
### Нещодавнє доповнення

Це нещодавнє доповнення до мови. У старих браузерах може бути потрібен поліфіл.

</Extra>

Оператор об’єднання з null записується як два знаки питання `??`.

Оскільки `null` і `undefined` сприймаються однаково, ми введемо спеціальну домовленність. В цій статті ми будемо вважати, що значення виразу “визначене”, якщо воно відрізняється від `null` та undefined.

Результатом `a ?? b` буде:

`a`, якщо `a` визначене,
`b`, якщо `a` не визначене.
Інакше кажучи, `??` повертає перший аргумент, якщо він не n`ull/undefined`. Інакше, другий.

Оператор об’єднання з null не є абсолютно новим. Це просто хороший синтаксис, щоб отримати перше “визначене” значення з двох.

Ми можемо переписати вираз `result = a ?? b`, використовуючи оператори, які ми вже знаємо:

<Code>

1. `result = (a !== null && a !== undefined) ? a : b;`

</Code>

Тепер повинно бути абсолютно зрозуміло, що робить `??`. Подивімось, де це допомагає.

Наприклад, тут ми показуємо значення у змінній `user`, якщо її значення не `null/undefined`, інакше – показуємо Анонімний:

Ось приклад з `user`, якому присвоєне ім’я:

<Code>

1. `let user = "Іван";`
2.
3. `alert(user ?? "Анонімний");`**// Іван (user визначений)**

</Code>

Ми також можемо використовувати послідовність з `??`, щоб вибрати перше значення зі списку, яке не є `null/undefined`.

Скажімо, у нас є дані користувача в змінних `firstName`, `lastName` або `nickName`. Всі вони можуть бути не визначені, якщо користувач вирішив не вводити значення.

Ми хотіли б показати ім’я користувача, використовуючи одну з цих змінних, або показати “Анонімний”, якщо всі вони `null/undefined`.

Використаймо оператор ?? для цього:

<Code>

1. `let firstName = null;`
2. `let lastName = null;`
3. `let nickName = "Суперкодер";`
4.
5. **// показує перше визначене значення:**
6. `alert(firstName ?? lastName ?? nickName ?? "Анонімний");` **// Суперкодер**

</Code>

</Column>

<Column id="porivnyannya-z">
## Порівняння з ||

Оператор АБО `||` може бути використаний таким же чином, як `??`, як це було описано в попередній главі.

Наприклад, у коді вище, ми могли б замінити `??` на `||` і все ще отримали б той самий результат:

<Code>

1. `let firstName = null;`
2. `let lastName = null;`
3. `let nickName = "Суперкодер";`
4.
5. `// показує перше істинне значення:`
6. `alert(firstName || lastName || nickName || "Анонімний");` **// Суперкодер**

</Code>

Історично, оператор АБО `||` був першим. Він існує з початку JavaScript, тому розробники використовували його для цих цілей протягом тривалого часу.

З іншого боку, оператор об’єднання з null `??` було нещодавно додано в JavaScript, і причиною того було те, що люди були не дуже задоволені `||`.

Важлива різниця між ними полягає в тому, що:

`||` повертає перше істинне значення.
`??` повертає перше визначене значення.
Інакше кажучи, оператор `||` не розрізняє, чи значення `false`, `0`, порожній рядок `""` чи `null/undefined`. Всі вони однакові – хибні значення. Якщо будь-яке з них є першим аргументом `||`, тоді ми отримаємо другий аргумент як результат.

Однак на практиці, ми хочемо використовувати типове значення лише тоді, коли змінна `null/undefined`. Тобто, коли значення дійсно невідоме/не встановлене.

Наприклад, розгляньте це:

<Code>

1. `let height = 0;`
2. `alert(height || 100);`**//100**
3. `alert(height ?? 100);`**//0**

</Code>

- `height || 100` перевіряє чи має змінна `height` має хибне значення, і `0` – це дійсно хибне значення. Отже, результатом `||` є другий аргумент, 100.
- `height ?? 100` перевіряє змінну `height`, чи вона `null/undefined`, і це не так, отже, результат – `height` “як є”, тобто `0`.

На практиці нульова висота часто є дійсним значенням, яке не слід замінювати на типове значення. Отже, ?? робить саме те, що треба.

</Column>

<Column id="prioritet">
## Пріоритет

Пріоритет оператора `??` такий самий, як у `||`. Він дорівнює `3` у таблиці MDN.

Це означає, що, як і `||`, оператор об’єднання з null `??` оцінюється до `=` та `?`, але після більшості інших операцій, таких як `+`, `*`.

// важливо: використовуйте дужки let area = (height ?? 100) \* (width ?? 50);

alert(area); // 5000

</Column>

<Column id="vikoristannya-razom-z-abo">
## Використання ?? разом з && або ||

З міркувань безпеки, JavaScript забороняє використання `??` разом з операторами `&&` та `||`, якщо пріоритет явно не вказаний дужками.

Код нижче викликає синтаксичну помилку:

<Code>

1. `let x = 1 && 2 ?? 3;` **// Синтаксична помилка**

</Code>

Обмеження є досить спірним, воно було додано до специфікації мови з метою уникнення помилок програмування, коли люди почнуть переходити з || до ??.

Використовуйте явні дужки, щоб працювати з цим оператором:

<Code>

1. `let x = (1 && 2) ?? 3;`**// Працює**
2.
3. `alert(x); // 2`

</Code>

</Column>

<Column id ="pidsumki">
## Підсумки

Оператор об’єднання з null ?? надає короткий спосіб вибору першого “визначеного” значення зі списку.

Він використовується для присвоєння типових значень до змінних:

<Code>

1. **// встановлює height=100, якщо height null чи undefined**
2. `height = height ?? 100;`

</Code>

Оператор `??` має дуже низький пріоритет – трохи вищий, ніж `?` та `=`, тому розглядайте додавання дужок при використанні його у виразах.

Цей оператор заборонено використовувати з `||` або `&&` без явних дужок.

</Column>
